<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Download Excel File</title>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <style>
    #loading {
      display: none;
      color: green;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <h1>Download Excel File from Azure</h1>
  <button id="download-btn">Download Excel</button>
  <p id="loading">‚è≥ Downloading, please wait...</p>

  <script>
    $('#download-btn').on('click', function () {
      $('#loading').show();

      $.ajax({
        url: 'download.php', // call your PHP backend
        method: 'GET',
        xhrFields: {
          responseType: 'blob'
        },
        success: function (data) {
          $('#loading').hide();

          const blob = new Blob([data], {
            type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
          });
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'report.xlsx';
          a.click();
          window.URL.revokeObjectURL(url);
        },
        error: function () {
          $('#loading').hide();
          alert('Download failed.');
        }
      });
    });
  </script>
</body>

</html>
